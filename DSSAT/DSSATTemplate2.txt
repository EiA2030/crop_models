library(DSSAT)
library(magrittr)
library(dplyr)
soil_file<-system.file('extdata','SOIL.SOL',package='DSSAT')
all_profiles<-read_sol(soil_file)
single_profile<-read_sol(soil_file,id_soil='IB00000001')
single_profile

new_profile<-single_profile %>%
mutate(PEDON='IBNEW00001',
      SSAT=0.95*(2.65-SBDM)/2.65)

new_profile$PEDON[1]<-'IBNEW00001'
new_profile$SSAT[[1]]<-0.95*(2.65-single_profile$SBDM[[1]])/2.65
write_sol(new_profile,'SOIL.SOL',append=TRUE)


